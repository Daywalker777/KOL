Как создать MDI приложение визуально в MCK:

1. Создать проект (New Application), подготовить его для работы в MCK как обычно (сохранить, положить на форму TKOLProject, изменить свойство destProject, положить TKOLForm, снова сохранить, затем открыть полученный MCK-проект с именем указанным в свойстве destProject компонента TKOLProject).
2. Положить на форму компонент TKOLMDIClient.
3. Положить TKOLMainMenu, и добавить некоторое количество пунктов меню. Для одного из этих пунктов свойство WindowMenu может быть установлено в True. Если есть элемент с этим свойством, равным True, дочерние MDI-формы будут перечислены после этого пункта автоматически во время исполнения программы. (Если нет главного меню вообще, то кнопки из правой части заголовка дочерней MDI-формы (minimize, maximize и close) не смогут появляться в линейке отсутствующего главного меню при максимизации дочерней MDI формы.
4. Создайте новую форму. Сохраните модуль в той же директории. Положите на форму компонент TKOLMDIChild (он заменяет TKOLForm для дочерней формы MDI). Для свойства ParentForm выберите родительскую MDI форму из выпадающего списка. Если данное свойство не присвоено, дочерняя MDI форма не будет создаваться при запуске приложения. Вы можете создать ее желаемое число раз во время исполнения программы, используя примерно такой код:

  NewForm2( MDIChild, Form1 );

где MDIChild - это переменная для ссылки на созданную форму (может быть локальной переменной или как угодно - типа PForm2) и Form1 - это имя главной MDI формы.

Примечание1: в KOL/MCK возможно создавать и манипулировать несколько главных MDI форм, и размещать разумное число дочерних MDI-форм на них во время исполнения и во время разработки.
Примечание2: TKOLMDIClient должен быть единственным на родительской MDI форме.
Примечание3: Хотя и фозможно создать TKOLMDIClient как дочерний элемент по отношению не только к форме, но и к любому другому контролу, строго рекомендуется создавать его только как визуальный объект, дочерний по отношению к самой родительской MDI форме. Если вы все-таки положите его на другой визуальный объект, не позволяйте максимизироваться дочерним MDI формам! (Либо отменяйте операцию и симулируйти максимизацию изменением положения/размеров окна, либо запрещайте кнопку максимизации вообще). Возможны также другие непредсказуемые проблемы в этом случае.

---------------------------------------------------------
mailto: bonanzas@xcl.cjb.net
Web Page: http://xcl.cjb.net